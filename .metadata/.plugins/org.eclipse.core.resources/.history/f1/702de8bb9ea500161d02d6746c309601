package com.niit.shoppingcart.test;

import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import com.niit.shoppingcart.model.User;
import com.niit.shoppingcart.config.AppConfig;
import com.niit.shoppingcart.dao.UserDao;

public class UserTestCase {

	@Autowired
	UserDao dao;
	
	@Autowired 
	AnnotationConfigApplicationContext context;
	
	@Before
	public void init(){
		context = new AnnotationConfigApplicationContext(AppConfig.class);
		dao = (UserDao) context.getBean("UserDao");
	}
	
	@Test
	public void getUser() {
		Assert.assertNotNull("Get User", dao.getById(30));
	}
	
	@Test
	public void createUser(){
		
		int id = 1002;
		User e = new User();
		e.setId(id);
		e.setName("user 20");
		//e.setSalary(60000);
		
		dao.saveUser(e);
		
		Assert.assertNotNull("Get User", dao.getById(id));	
	}
	
	@Test
	public void deleteUser(){
		
		int id=100;
		
		// delete the User
		User emp = dao.getById(id);
		Assert.assertNotNull("check User exists", emp);
		
		if(emp != null){
			dao.deleteUser(emp);	
			Assert.assertNull("delete User", dao.getById(id));
		}		
	}
	
	@Test
	public void updateUser(){
		int id=100;
		
		// update the User
		User emp = dao.getById(id);
		Assert.assertNotNull("check User exists", emp);
		if(emp != null){
			emp.setName("updated name 1000");
			dao.updateUser(emp);
			
			Assert.assertEquals(emp, dao.getById(id));
		}
	}

	@Test
	public void getUserList() {
		Assert.assertNotNull("Get User", dao.getUsers());
		
		//Assert.assertEquals(10, dao.getUsers().size());
	}

}
