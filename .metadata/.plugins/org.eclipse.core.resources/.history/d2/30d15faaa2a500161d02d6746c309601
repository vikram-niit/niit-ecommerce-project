package com.niit.shoppingcart.test;

import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import com.niit.shoppingcart.Employee;
import com.niit.shoppingcart.config.AppConfig;
import com.niit.shoppingcart.dao.EmployeeDAO;



public class EmployeeTestCase {

	@Autowired
	EmployeeDAO dao;
	
	@Autowired 
	AnnotationConfigApplicationContext context;
	
	@Before
	public void init(){
		context = new AnnotationConfigApplicationContext();
		context.refresh();
		context.scan("com.niit.shoppingcart");
		dao = (EmployeeDAO) context.getBean("EmployeeDAO");
		
		System.out.println("dao="+dao);
	}
	
	@Test
	public void getEmployee() {
		Assert.assertNotNull("Get employee", dao.getById(14));
	}
	
	@Test
	public void createEmployee(){
		
		int id = 1001;
		Employee e = new Employee();
		e.setEid(id);
		e.setName("name 20");
		e.setSalary(60000);
		
		dao.saveEmployee(e);
		
		Assert.assertNotNull("Get employee", dao.getById(id));	
	}
	
	@Test
	public void deleteEmployee(){
		
		int id=100;
		
		// delete the employee
		Employee emp = dao.getById(id);
		Assert.assertNotNull("check employee exists", emp);
		
		if(emp != null){
			dao.deleteEmployee(emp);	
			Assert.assertNull("delete employee", dao.getById(id));
		}		
	}
	
	@Test
	public void updateEmployee(){
		int id=100;
		
		// update the employee
		Employee emp = dao.getById(id);
		Assert.assertNotNull("check employee exists", emp);
		if(emp != null){
			emp.setName("updated name 1000");
			dao.updateEmployee(emp);
			
			Assert.assertEquals(emp, dao.getById(id));
		}
	}

	@Test
	public void getEmployeeList() {
		Assert.assertNotNull("Get employee", dao.getEmployees());
		
		//Assert.assertEquals(10, dao.getEmployees().size());
	}
}
